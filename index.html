<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Zen Read</title>
                <link rel="manifest" href="manifest.json">
                    <meta name="theme-color" content="#fdfdfd">
                        <link rel="stylesheet" href="style.css">
                        </head>
                        <body>
                            <div class="container">
                                    <header>
                                                <div class="logo">Zen Read</div>
                                                        </header>
                                                                <main>
                                                                            <section class="input-area">
                                                                                            <h1>静寂の中で、<br>知識を吸収する。</h1>
                                                                                                            <p class="subtitle">読みたい記事のURLまたはテキストを入力してください。</p>
                                                                                                                            <div class="input-group">
                                                                                                                                                <input type="text" placeholder="URLまたはテキストを貼り付け..." id="content-input">
                                                                                                                                                                    <button id="convert-btn">読書を開始</button>
                                                                                                                                                                                    </div>
                                                                                                                                                                                                </section>
                                                                                                                                                                                                            <section id="result-area" class="hidden">
                                                                                                                                                                                                                            <div class="paper">
                                                                                                                                                                                                                                                <p></p>
                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                            </section>
                                                                                                                                                                                                                                                                                    </main>
                                                                                                                                                                                                                                                                                            <footer>
                                                                                                                                                                                                                                                                                                        <p>© 2026 Zen Read Project</p>
                                                                                                                                                                                                                                                                                                                </footer>
                                                                                                                                                                                                                                                                                                                    </div>

                                                                                                                                                                                                                                                                                                                        <script src="sw.js"></script>
                                                                                                                                                                                                                                                                                                                            <script>
                                                                                                                                                                                                                                                                                                                                    if ('serviceWorker' in navigator) {
                                                                                                                                                                                                                                                                                                                                                navigator.serviceWorker.register('sw.js');
                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                const convertBtn = document.getElementById('convert-btn');
                                                                                                                                                                                                                                                                                                                                                                        const input = document.getElementById('content-input');
                                                                                                                                                                                                                                                                                                                                                                                const resultArea = document.getElementById('result-area');
                                                                                                                                                                                                                                                                                                                                                                                        const resultText = document.querySelector('.paper p'); 

                                                                                                                                                                                                                                                                                                                                                                                                convertBtn.addEventListener('click', async () => {
                                                                                                                                                                                                                                                                                                                                                                                                            const text = input.value;
                                                                                                                                                                                                                                                                                                                                                                                                                        if (!text) return;

                                                                                                                                                                                                                                                                                                                                                                                                                                    convertBtn.innerText = "AIが思考中...";
                                                                                                                                                                                                                                                                                                                                                                                                                                                convertBtn.disabled = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                            resultArea.classList.remove('hidden');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        resultText.innerText = "静寂の中で読んでいます...";

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const response = await fetch('/api/summarize', {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        method: 'POST',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            headers: { 'Content-Type': 'application/json' },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                body: JSON.stringify({ text })
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const data = await response.json();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (data.summary) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    resultText.innerHTML = data.summary.replace(/\n/g, '<br>');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        resultText.innerText = "読み込み失敗。もう一度試してください。";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } catch (error) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    resultText.innerText = "エラーが発生しました。";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } finally {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                convertBtn.innerText = "読書を開始";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                convertBtn.disabled = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        